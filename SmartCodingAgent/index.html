<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Coding Agent - Workspace</title>
    <link rel="stylesheet" href="styles/tokens.css" />
    <link rel="stylesheet" href="styles/base.css" />
    <link rel="stylesheet" href="styles/utilities.css" />
    <link rel="stylesheet" href="styles/components.css" />
    <link rel="stylesheet" href="styles/layouts.css" />
    <link rel="stylesheet" href="styles/themes.css" />
    <link rel="stylesheet" href="styles/print.css" />
  </head>
  <body class="theme--light">
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Global Shell -->
    <header class="shell__header">
      <div class="shell__header-content">
        <h1 class="shell__title">
          <span class="shell__icon">🤖</span>
          Smart Coding Agent
        </h1>
        <div class="shell__controls">
          <div class="repo-selector">
            <span class="repo-selector__name">my-project</span>
            <span class="badge badge--branch">main</span>
          </div>
          <button class="btn btn--ghost" aria-label="Print workspace">
            <span class="btn__icon">🖨️</span>
          </button>
        </div>
      </div>
    </header>

    <div class="shell__body">
      <nav class="shell__sidebar">
        <ul class="nav">
          <li class="nav__item">
            <a
              href="index.html"
              class="nav__link nav__link--active"
              aria-current="page"
            >
              <span class="nav__icon">💻</span>
              Workspace
            </a>
          </li>
          <li class="nav__item">
            <a href="diff.html" class="nav__link">
              <span class="nav__icon">📊</span>
              Diff Review
            </a>
          </li>
          <li class="nav__item">
            <a href="tests.html" class="nav__link">
              <span class="nav__icon">🧪</span>
              Tests
            </a>
          </li>
          <li class="nav__item">
            <a href="perf.html" class="nav__link">
              <span class="nav__icon">⚡</span>
              Performance
            </a>
          </li>
          <li class="nav__item">
            <a href="playbooks.html" class="nav__link">
              <span class="nav__icon">📚</span>
              Playbooks
            </a>
          </li>
          <li class="nav__item">
            <a href="settings.html" class="nav__link">
              <span class="nav__icon">⚙️</span>
              Settings
            </a>
          </li>
          <li class="nav__item">
            <a href="about.html" class="nav__link">
              <span class="nav__icon">ℹ️</span>
              About
            </a>
          </li>
        </ul>

        <div class="project-tree">
          <h3 class="project-tree__title">Project Files</h3>
          <ul class="project-tree__list">
            <li class="project-tree__item">
              <span class="project-tree__icon">📁</span>
              src/
              <ul class="project-tree__list project-tree__list--nested">
                <li class="project-tree__item">
                  <span class="project-tree__icon">📄</span>
                  app.tsx
                </li>
                <li class="project-tree__item">
                  <span class="project-tree__icon">📄</span>
                  table.ts
                </li>
                <li class="project-tree__item">
                  <span class="project-tree__icon">📄</span>
                  types.ts
                </li>
              </ul>
            </li>
            <li class="project-tree__item">
              <span class="project-tree__icon">📄</span>
              package.json
            </li>
          </ul>
        </div>

        <div class="theme-toggle">
          <button class="btn btn--ghost" aria-label="Toggle theme">
            <span class="btn__icon">🌙</span>
          </button>
        </div>
      </nav>

      <main id="main-content" class="shell__main">
        <!-- Workspace Page -->
        <div class="workspace">
          <!-- Top Bar -->
          <div class="workspace__top-bar">
            <div class="breadcrumbs">
              <span class="breadcrumbs__item">src</span>
              <span class="breadcrumbs__separator">/</span>
              <span class="breadcrumbs__item">table.ts</span>
            </div>
            <div class="file-status">
              <span class="badge badge--modified">M</span>
              <span class="badge badge--added">A</span>
              <span class="badge badge--removed">R</span>
            </div>
            <div class="search-box">
              <input
                type="search"
                class="search-box__input"
                placeholder="Search files..."
                aria-label="Search files"
              />
            </div>
          </div>

          <!-- 3-Pane Layout -->
          <div class="workspace__panes">
            <!-- Code Pane -->
            <div class="workspace__pane workspace__pane--code">
              <div class="code-block">
                <div class="code-block__header">
                  <span class="code-block__filename">src/table.ts</span>
                  <div class="code-block__actions">
                    <button
                      class="btn btn--sm btn--ghost"
                      aria-label="Copy code"
                    >
                      📋
                    </button>
                  </div>
                </div>
                <div class="code-block__content">
                  <pre
                    class="code"
                  ><code><span class="code__line"><span class="code__line-number">85</span><span class="code__line-content">  <span class="code__annotation" data-annotation="error">🔎</span>export function buildRows(rows: Row[]) {</span></span>
<span class="code__line"><span class="code__line-number">86</span><span class="code__line-content">    if (!rows.length) return [];</span></span>
<span class="code__line code__line--error"><span class="code__line-number">87</span><span class="code__line-content">    <span class="code__annotation" data-annotation="warning">⚠️</span>return rows.map(r => toView(r));</span></span>
<span class="code__line"><span class="code__line-number">88</span><span class="code__line-content">  }</span></span></code></pre>
                </div>
              </div>
            </div>

            <!-- Chat Pane -->
            <div class="workspace__pane workspace__pane--chat">
              <div class="chat">
                <div class="chat__messages">
                  <div class="chat__message chat__message--user">
                    <div class="chat__bubble chat__bubble--user">
                      <p>
                        I'm getting a TypeError: cannot read property 'map' of
                        undefined at line 87. Can you help debug this?
                      </p>
                    </div>
                  </div>

                  <div class="chat__message chat__message--agent">
                    <div class="chat__bubble chat__bubble--agent">
                      <div class="chat__content">
                        <p>
                          <strong>Root cause:</strong> <code>rows</code> is
                          <code>undefined</code> when API returns
                          <code>{ data: null }</code>.
                        </p>
                        <p>
                          <strong>Fix (risk: low):</strong> Default
                          <code>rows = []</code> and guard in
                          <code>buildRows</code>.
                        </p>
                        <p>
                          <strong>Patch size:</strong> 6 lines; files:
                          <code>src/table.ts</code>, <code>src/types.ts</code>.
                        </p>

                        <details class="chat__details">
                          <summary>Why this approach?</summary>
                          <p>
                            This is a defensive programming pattern that
                            prevents runtime errors when the API returns
                            unexpected data structures. The default parameter
                            ensures the function always receives a valid array.
                          </p>
                        </details>
                      </div>

                      <div class="actions">
                        <button class="actions__btn actions__btn--fix">
                          Fix
                        </button>
                        <button class="actions__btn actions__btn--explain">
                          Explain
                        </button>
                        <button class="actions__btn actions__btn--test">
                          Test
                        </button>
                        <button class="actions__btn actions__btn--optimize">
                          Optimize
                        </button>
                        <button class="actions__btn actions__btn--doc">
                          Doc
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="chat__input">
                  <form class="chat__form">
                    <textarea
                      class="chat__textarea"
                      placeholder="Ask about your code..."
                      rows="3"
                    ></textarea>
                    <button type="submit" class="btn btn--primary">Send</button>
                  </form>
                </div>
              </div>
            </div>

            <!-- Context Pane -->
            <div class="workspace__pane workspace__pane--context">
              <div class="context-panel">
                <div class="context-panel__section">
                  <h3 class="context-panel__title">Stack Trace</h3>
                  <div class="stack-trace">
                    <div class="stack-trace__line stack-trace__line--error">
                      <span class="stack-trace__type">TypeError:</span>
                      <span class="stack-trace__message"
                        >cannot read property 'map' of undefined</span
                      >
                    </div>
                    <div class="stack-trace__line">
                      <span class="stack-trace__location"
                        >at buildRows (src/table.ts:87)</span
                      >
                    </div>
                    <div class="stack-trace__line">
                      <span class="stack-trace__location"
                        >at render (src/app.tsx:142)</span
                      >
                    </div>
                  </div>
                </div>

                <div class="context-panel__section">
                  <h3 class="context-panel__title">Environment</h3>
                  <div class="env-vars">
                    <div class="env-vars__item">
                      <span class="env-vars__key">NODE_ENV:</span>
                      <span class="env-vars__value">development</span>
                    </div>
                    <div class="env-vars__item">
                      <span class="env-vars__key">API_URL:</span>
                      <span class="env-vars__value">http://localhost:3000</span>
                    </div>
                  </div>
                </div>

                <div class="context-panel__section">
                  <h3 class="context-panel__title">Dependencies</h3>
                  <div class="deps-list">
                    <div class="deps-list__item">
                      <span class="deps-list__name">react</span>
                      <span class="deps-list__version">^18.2.0</span>
                    </div>
                    <div class="deps-list__item">
                      <span class="deps-list__name">typescript</span>
                      <span class="deps-list__version">^5.0.0</span>
                    </div>
                  </div>
                </div>

                <div class="context-panel__section">
                  <h3 class="context-panel__title">Test Summary</h3>
                  <div class="test-summary">
                    <div class="test-summary__stats">
                      <span class="test-summary__stat">
                        <span class="test-summary__label">Passed:</span>
                        <span
                          class="test-summary__value test-summary__value--success"
                          >12</span
                        >
                      </span>
                      <span class="test-summary__stat">
                        <span class="test-summary__label">Failed:</span>
                        <span
                          class="test-summary__value test-summary__value--error"
                          >1</span
                        >
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Status Bar -->
    <footer class="shell__footer">
      <div class="status-bar">
        <div class="status-bar__left">
          <span class="status-bar__model">GPT-4</span>
          <span class="status-bar__tokens">~2.1k tokens</span>
        </div>
        <div class="status-bar__right">
          <span class="status-bar__latency">—</span>
          <span class="status-bar__git">main*</span>
        </div>
      </div>
    </footer>

    <!-- Command Palette (Visual) -->
    <div class="palette" id="command-palette" hidden>
      <div class="palette__overlay"></div>
      <div class="palette__content">
        <div class="palette__header">
          <input
            type="search"
            class="palette__input"
            placeholder="Type a command or search..."
            autofocus
          />
        </div>
        <div class="palette__list">
          <div class="palette__item">
            <span class="palette__icon">🔧</span>
            <span class="palette__label">Fix Code</span>
            <span class="palette__shortcut">Ctrl+F</span>
          </div>
          <div class="palette__item">
            <span class="palette__icon">💡</span>
            <span class="palette__label">Explain Code</span>
            <span class="palette__shortcut">Ctrl+E</span>
          </div>
          <div class="palette__item">
            <span class="palette__icon">🧪</span>
            <span class="palette__label">Generate Tests</span>
            <span class="palette__shortcut">Ctrl+T</span>
          </div>
          <div class="palette__item">
            <span class="palette__icon">⚡</span>
            <span class="palette__label">Optimize Performance</span>
            <span class="palette__shortcut">Ctrl+O</span>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
